<!--
  ~ Copyright (c) 2022 Merative.com 
  ~ @Author: Henry Feldman, M.D.. 
  ~ All Rights Reserved
  -->

{% extends "dark_layout.html" %}

{% block content %}
<!-- Breadcrumb-->
    <div class="container-fluid">
<nav class="navbar navbar-expand-lg navbar-light bg-light">
<ol class="breadcrumb">
    <li class="breadcrumb-item">Home</li>
    <li class="breadcrumb-item">
        <a href="#">Home</a>
    </li>
    <!-- Breadcrumb Menu-->
</ol>
</nav>

<h3>Chest Xrays</h3>
        <h4> Page {{page_number}}</h4>

        <div id="status_div"></div>
<table class="table">
    <tr><th>id</th><th>image</th><th>Device</th></tr>
{% for xray in xrays %}
            <tr>
                <td>{{ xray.id }}</td>
                <td><a href="/view_xray_full?id={{xray.id}}" target="_blank"><img src="/load_image?id={{xray.id}}" width="256px"></a></td>
                <td>
                <div class="mb-3 form-check">
                       <a class="btn btn-primary" href="javascript:setPositive({{xray.id}})" id="button_{{xray.id}}" role="button">Set To Positive</a>
                       <a class="btn btn-warning" href="javascript:setNegative({{xray.id}})" id="button_{{xray.id}}" role="button">Undo To Negative</a>

                </div>

                </td>
           </tr>
{% endfor %}
</table>
           <form action="/update_xrays" method="post" enctype="multipart/form-data">
           <input type="hidden" id="pageNumber" name="pageNumber" value="{page_number}" />
           <input type="hidden" id="max_id" name="max_id" value="{{ xrays[-1].id }}" />
           <button type="submit" class="btn btn-primary">Submit</button>
            </form>
</div>

     <script>
    function setPositive(image_id) {
      const xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          document.getElementById("status_div").innerHTML =
          "changed " + image_id;
        }
      };
      var url = '/set_positive?id=' + image_id;
      xhttp.open("GET", url, true);
      xhttp.send();
    }

       function setNegative(image_id) {
      const xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          document.getElementById("status_div").innerHTML =
          "changed " + image_id;
        }
      };
      var url = '/set_negative?id=' + image_id;
      xhttp.open("GET", url, true);
      xhttp.send();
    }

    </script>

{% endblock %}
